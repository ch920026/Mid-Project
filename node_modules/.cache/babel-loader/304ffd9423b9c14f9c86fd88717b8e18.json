{"ast":null,"code":"import _slicedToArray from \"/Users/Hsi/Desktop/WebProg2019/mid/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/Hsi/Desktop/WebProg2019/mid/src/index.js\";\nimport React, { useState, useEffect } from \"react\";\nimport ReactDom from \"react-dom\";\nimport \"./index.css\";\nimport webSocket from \"socket.io-client\";\nimport File from \"./components/File\";\nimport Chat from \"./components/Question\";\n\nconst Main = () => {\n  // Getting Elements\n  const element = id => {\n    return document.getElementById(id);\n  };\n\n  const status = element(\"status\");\n  const messages = element(\"messages\");\n  const textarea = element(\"textarea\");\n  const username = element(\"username\");\n  const clearBtn = element(\"clear\");\n  const fileName = element(\"filename\");\n  const fileUrl = element(\"url\");\n\n  const _useState = useState(null),\n        _useState2 = _slicedToArray(_useState, 2),\n        socket = _useState2[0],\n        setSocket = _useState2[1];\n\n  const connectWebSocket = () => {\n    setSocket(webSocket(\"http://localhost:3000\")); //開啟\n  };\n\n  useEffect(() => {\n    if (socket) {\n      console.log(status.textContent);\n      initWebSocket();\n    }\n  }, [socket]);\n\n  const updateList = data => {\n    for (let x = 0; x < data.length; x++) {\n      // Building out message div\n      const message = document.createElement(\"div\");\n      message.setAttribute(\"class\", \"chat-message\");\n      message.textContent = data[x].name + \": \" + data[x].body;\n      messages.appendChild(message); //            messages.insertBefore(message, messages.firstChild)\n    }\n  };\n\n  const initWebSocket = () => {\n    //對 getMessage 設定監聽，如果 server 有透過 getMessage 傳送訊息，將會在此被捕捉\n    socket.on(\"getMessage\", message => {\n      console.log(message);\n    });\n    socket.on(\"fileOutput\", data => {\n      const showPdf = element(\"showPdf\");\n      showPdf.setAttribute(\"src\", data.url);\n    });\n    socket.on(\"init\", data => {\n      if (data.length && messages.childNodes.length === 0) updateList(data);\n    });\n  };\n\n  const sendMessage = () => {\n    //以 emit 送訊息，並以 getMessage 為名稱送給 server 捕捉\n    socket.emit(\"getMessage\", \"只回傳給發送訊息的 client\");\n  };\n\n  const add = e => {\n    if (e.key === \"Enter\" && e.shiftKey == false) {\n      // Emit to server input\n      console.log(\"launch\");\n      socket.emit(\"file\", {\n        filename: fileName.value,\n        url: fileUrl.value\n      });\n    }\n  };\n\n  const Question = e => {\n    if (e.key === \"Enter\" && e.shiftKey == false) {\n      // Emit to server input\n      socket.emit(\"input\", {\n        name: username.value,\n        body: textarea.value\n      });\n    }\n  };\n\n  return React.createElement(\"div\", {\n    className: \"Wrapper\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88\n    },\n    __self: this\n  }, React.createElement(\"input\", {\n    type: \"button\",\n    value: \"\\u9023\\u7DDA\",\n    onClick: connectWebSocket,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89\n    },\n    __self: this\n  }), React.createElement(\"input\", {\n    type: \"button\",\n    value: \"\\u9001\\u51FA\\u8A0A\\u606F\",\n    onClick: sendMessage,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: \"container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91\n    },\n    __self: this\n  }, React.createElement(\"button\", {\n    id: \"clear\",\n    className: \"btn btn-danger\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92\n    },\n    __self: this\n  }, \"Clear\"), React.createElement(\"div\", {\n    className: \"row\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"Add\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96\n    },\n    __self: this\n  }, React.createElement(File, {\n    add: add,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97\n    },\n    __self: this\n  }), React.createElement(\"iframe\", {\n    src: \"https://www.tutorialspoint.com/mongodb/mongodb_tutorial.pdf\",\n    id: \"showPdf\",\n    frameBorder: \"0\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98\n    },\n    __self: this\n  })), React.createElement(Chat, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104\n    },\n    __self: this\n  }))));\n};\n\nReactDom.render(React.createElement(Main, {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 111\n  },\n  __self: this\n}), document.getElementById(\"root\"));","map":{"version":3,"sources":["/Users/Hsi/Desktop/WebProg2019/mid/src/index.js"],"names":["React","useState","useEffect","ReactDom","webSocket","File","Chat","Main","element","id","document","getElementById","status","messages","textarea","username","clearBtn","fileName","fileUrl","socket","setSocket","connectWebSocket","console","log","textContent","initWebSocket","updateList","data","x","length","message","createElement","setAttribute","name","body","appendChild","on","showPdf","url","childNodes","sendMessage","emit","add","e","key","shiftKey","filename","value","Question","render"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport ReactDom from \"react-dom\";\nimport \"./index.css\";\nimport webSocket from \"socket.io-client\";\nimport File from \"./components/File\";\nimport Chat from \"./components/Question\";\n\nconst Main = () => {\n  // Getting Elements\n  const element = id => {\n    return document.getElementById(id);\n  };\n  const status = element(\"status\");\n  const messages = element(\"messages\");\n  const textarea = element(\"textarea\");\n  const username = element(\"username\");\n  const clearBtn = element(\"clear\");\n  const fileName = element(\"filename\");\n  const fileUrl = element(\"url\");\n  const [socket, setSocket] = useState(null);\n\n  const connectWebSocket = () => {\n    setSocket(webSocket(\"http://localhost:3000\"));\n    //開啟\n  };\n\n  useEffect(() => {\n    if (socket) {\n      console.log(status.textContent);\n      initWebSocket();\n    }\n  }, [socket]);\n\n  const updateList = data => {\n    for (let x = 0; x < data.length; x++) {\n      // Building out message div\n      const message = document.createElement(\"div\");\n      message.setAttribute(\"class\", \"chat-message\");\n      message.textContent = data[x].name + \": \" + data[x].body;\n      messages.appendChild(message);\n      //            messages.insertBefore(message, messages.firstChild)\n    }\n  };\n\n  const initWebSocket = () => {\n    //對 getMessage 設定監聽，如果 server 有透過 getMessage 傳送訊息，將會在此被捕捉\n    socket.on(\"getMessage\", message => {\n      console.log(message);\n    });\n\n    socket.on(\"fileOutput\", data => {\n      const showPdf = element(\"showPdf\");\n\n      showPdf.setAttribute(\"src\", data.url);\n    });\n\n    socket.on(\"init\", data => {\n      if (data.length && messages.childNodes.length === 0) updateList(data);\n    });\n  };\n\n  const sendMessage = () => {\n    //以 emit 送訊息，並以 getMessage 為名稱送給 server 捕捉\n    socket.emit(\"getMessage\", \"只回傳給發送訊息的 client\");\n  };\n\n  const add = e => {\n    if (e.key === \"Enter\" && e.shiftKey == false) {\n      // Emit to server input\n      console.log(\"launch\");\n      socket.emit(\"file\", {\n        filename: fileName.value,\n        url: fileUrl.value\n      });\n    }\n  };\n  const Question = e => {\n    if (e.key === \"Enter\" && e.shiftKey == false) {\n      // Emit to server input\n      socket.emit(\"input\", {\n        name: username.value,\n        body: textarea.value\n      });\n    }\n  };\n\n  return (\n    <div className=\"Wrapper\">\n      <input type=\"button\" value=\"連線\" onClick={connectWebSocket} />\n      <input type=\"button\" value=\"送出訊息\" onClick={sendMessage} />\n      <div className=\"container\">\n        <button id=\"clear\" className=\"btn btn-danger\">\n          Clear\n        </button>\n        <div className=\"row\">\n          <div className=\"Add\">\n            <File add={add} />\n            <iframe\n              src=\"https://www.tutorialspoint.com/mongodb/mongodb_tutorial.pdf\"\n              id=\"showPdf\"\n              frameBorder=\"0\"\n            />\n          </div>\n          <Chat />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nReactDom.render(<Main />, document.getElementById(\"root\"));\n"]},"metadata":{},"sourceType":"module"}