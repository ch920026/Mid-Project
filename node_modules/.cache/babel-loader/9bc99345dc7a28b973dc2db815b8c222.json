{"ast":null,"code":"import _slicedToArray from \"/Users/Hsi/Desktop/WebProg2019/mid/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/Hsi/Desktop/WebProg2019/mid/src/container/App.js\";\nimport React, { useState, useEffect, Component } from \"react\";\nimport { BrowserRouter, NavLink, Switch, Route, Redirect } from \"react-router-dom\";\nimport ReactDom from \"react-dom\";\nimport \"../index.css\";\nimport ReactDOM from \"react-dom\";\nimport webSocket from \"socket.io-client\";\nimport File from \"../components/File\";\nimport Chat from \"../components/Question\";\nimport Menu from \"./menu\";\nimport PDF from \"../components/PDF\";\nimport ClassList from \"./Posts/ClassList\";\nimport Slide from \"./Posts/Slide\";\nimport \"antd/dist/antd.css\";\nimport { relativeTimeRounding } from \"moment\"; //=============================Variables=================================\n\nfunction App() {\n  // Getting Elements\n  const element = id => {\n    return document.getElementById(id);\n  };\n\n  const status = element(\"status\");\n  const messages = element(\"messages\");\n  const textarea = element(\"textarea\");\n  const username = element(\"username\");\n  const classMenu = element(\"classMenu\");\n  let fileArray = [];\n  const list = element(\"list\");\n\n  const _useState = useState(null),\n        _useState2 = _slicedToArray(_useState, 2),\n        socket = _useState2[0],\n        setSocket = _useState2[1];\n\n  let c = 0;\n  let test = [];\n  let a = document.createElement(\"div\"); //==============================Server=================================\n\n  const connectWebSocket = () => {//開啟\n  };\n\n  useEffect(() => {\n    if (c === 0) {\n      setSocket(webSocket(\"http://localhost:3000\"));\n      c = 1;\n    }\n  }, [c]);\n  useEffect(() => {\n    if (socket) {\n      initWebSocket();\n    }\n  }, [socket]);\n\n  const initWebSocket = () => {\n    //對 getMessage 設定監聽，如果 server 有透過 getMessage 傳送訊息，將會在此被捕捉\n    socket.on(\"getMessage\", message => {\n      console.log(message);\n    });\n    socket.on(\"fileOutput\", data => {\n      fileArray.push(data);\n    });\n    socket.on(\"fileRender\", data => {\n      fileArray = data.slice(0);\n\n      if (data.length && classMenu && classMenu.childNodes.length === 0) {\n        updateFile(data);\n      }\n    });\n    socket.on(\"init\", data => {\n      if (data.length && messages.childNodes.length === 0) updateList(data);\n    });\n    socket.on(\"output\", data => {\n      if (data.length) updateList(data);\n    });\n    socket.on(\"cleared\", () => {\n      clearList();\n    });\n    socket.on(\"status\", data => {\n      setStatus(typeof data === \"object\" ? data.message : data); // If status is clear, clear text\n\n      if (data.clear) {\n        textarea.value = \"\";\n      }\n    });\n  }; //=======================================Ask===========================================\n\n\n  const sendMessage = () => {\n    //以 emit 送訊息，並以 getMessage 為名稱送給 server 捕捉\n    socket.emit(\"getMessage\", \"只回傳給發送訊息的 client\");\n  };\n\n  const updateList = data => {\n    for (let x = 0; x < data.length; x++) {\n      // Building out message div\n      const message = document.createElement(\"div\");\n      message.setAttribute(\"class\", \"chat-message\");\n      message.textContent = data[x].name + \": \" + data[x].body;\n      messages.appendChild(message); //            messages.insertBefore(message, messages.firstChild)\n    }\n  };\n\n  const updateFile = data => {\n    fileArray = data.slice(0);\n  };\n\n  const Question = e => {\n    if (e.key === \"Enter\" && e.shiftKey == false) {\n      // Emit to server input\n      socket.emit(\"input\", {\n        name: username.value,\n        body: textarea.value\n      });\n      e.preventDefault();\n      textarea.value = \"\";\n    }\n  }; //====================================Clear========================================\n\n\n  const Clear = () => {\n    clearList();\n    socket.emit(\"clear\");\n  }; // Clear Message\n\n\n  const clearList = () => {\n    messages.textContent = \"\";\n    username.value = \"\";\n    username.focus();\n  }; //======================================File=======================================\n\n\n  const add = () => {\n    // Emit to server input\n    const fileName = document.getElementById(\"filename\");\n    const fileUrl = document.getElementById(\"url\");\n    const status = document.getElementById(\"status\");\n    var check = checkUrl(fileUrl.value);\n\n    if (check === \"pdf\") {\n      socket.emit(\"file\", {\n        filename: fileName.value,\n        url: fileUrl.value\n      });\n      fileUrl.value = \"\";\n      fileName.value = \"\";\n      status.style.color = \"lightgreen\";\n    } else {\n      setStatus(\"This is not a pdf\");\n      status.style.color = \" rgb(172, 51, 51)\";\n      console.log(\"not a pdf\");\n    }\n  };\n\n  const deleteFile = e => {\n    console.log(e.target);\n  };\n\n  const checkUrl = url => {\n    var lastChar = url.substring(url.length - 3, url.length);\n    return lastChar;\n  }; //=====================================Satus=======================================\n\n\n  const setStatus = s => {\n    // Setting status\n    const status = document.getElementById(\"status\");\n    status.textContent = s; // Resetting status to default every x seconds\n\n    if (s !== \"\") {\n      setTimeout(() => {\n        setStatus(\"\");\n      }, 2000);\n    }\n  }; //==================================================================================\n\n\n  return React.createElement(BrowserRouter, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"Wrapper\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"row\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190\n    },\n    __self: this\n  }, React.createElement(Menu, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: \"Add\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192\n    },\n    __self: this\n  }, React.createElement(Switch, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193\n    },\n    __self: this\n  }, React.createElement(Route, {\n    path: \"/home\",\n    render: props => React.createElement(File, Object.assign({}, props, {\n      add: add,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196\n      },\n      __self: this\n    })),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194\n    },\n    __self: this\n  }), React.createElement(Route, {\n    path: \"/classes/\",\n    render: props => React.createElement(ClassList, Object.assign({}, props, {\n      fileArray: fileArray,\n      d: deleteFile,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201\n      },\n      __self: this\n    })),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198\n    },\n    __self: this\n  }), \" \", \"/>\", React.createElement(Route, {\n    path: \"/class/:id?\",\n    render: props => React.createElement(Slide, Object.assign({}, props, {\n      fileArray: fileArray,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211\n      },\n      __self: this\n    })),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209\n    },\n    __self: this\n  }))), React.createElement(Chat, {\n    ask: Question,\n    Clear: Clear,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215\n    },\n    __self: this\n  })))));\n}\n\nexport default App;\n/*\n render={props => (\n                    <ClassList {...props} fileArray={fileArray} />\n                  )}\n                  */","map":{"version":3,"sources":["/Users/Hsi/Desktop/WebProg2019/mid/src/container/App.js"],"names":["React","useState","useEffect","Component","BrowserRouter","NavLink","Switch","Route","Redirect","ReactDom","ReactDOM","webSocket","File","Chat","Menu","PDF","ClassList","Slide","relativeTimeRounding","App","element","id","document","getElementById","status","messages","textarea","username","classMenu","fileArray","list","socket","setSocket","c","test","a","createElement","connectWebSocket","initWebSocket","on","message","console","log","data","push","slice","length","childNodes","updateFile","updateList","clearList","setStatus","clear","value","sendMessage","emit","x","setAttribute","textContent","name","body","appendChild","Question","e","key","shiftKey","preventDefault","Clear","focus","add","fileName","fileUrl","check","checkUrl","filename","url","style","color","deleteFile","target","lastChar","substring","s","setTimeout","props"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, Component } from \"react\";\nimport {\n  BrowserRouter,\n  NavLink,\n  Switch,\n  Route,\n  Redirect\n} from \"react-router-dom\";\nimport ReactDom from \"react-dom\";\nimport \"../index.css\";\nimport ReactDOM from \"react-dom\";\nimport webSocket from \"socket.io-client\";\nimport File from \"../components/File\";\nimport Chat from \"../components/Question\";\nimport Menu from \"./menu\";\nimport PDF from \"../components/PDF\";\nimport ClassList from \"./Posts/ClassList\";\nimport Slide from \"./Posts/Slide\";\n\nimport \"antd/dist/antd.css\";\nimport { relativeTimeRounding } from \"moment\";\n//=============================Variables=================================\nfunction App() {\n  // Getting Elements\n  const element = id => {\n    return document.getElementById(id);\n  };\n  const status = element(\"status\");\n  const messages = element(\"messages\");\n  const textarea = element(\"textarea\");\n  const username = element(\"username\");\n  const classMenu = element(\"classMenu\");\n  let fileArray = [];\n  const list = element(\"list\");\n  const [socket, setSocket] = useState(null);\n  let c = 0;\n  let test = [];\n  let a = document.createElement(\"div\");\n  //==============================Server=================================\n  const connectWebSocket = () => {\n    //開啟\n  };\n\n  useEffect(() => {\n    if (c === 0) {\n      setSocket(webSocket(\"http://localhost:3000\"));\n\n      c = 1;\n    }\n  }, [c]);\n\n  useEffect(() => {\n    if (socket) {\n      initWebSocket();\n    }\n  }, [socket]);\n\n  const initWebSocket = () => {\n    //對 getMessage 設定監聽，如果 server 有透過 getMessage 傳送訊息，將會在此被捕捉\n    socket.on(\"getMessage\", message => {\n      console.log(message);\n    });\n\n    socket.on(\"fileOutput\", data => {\n      fileArray.push(data);\n    });\n    socket.on(\"fileRender\", data => {\n      fileArray = data.slice(0);\n\n      if (data.length && classMenu && classMenu.childNodes.length === 0) {\n        updateFile(data);\n      }\n    });\n\n    socket.on(\"init\", data => {\n      if (data.length && messages.childNodes.length === 0) updateList(data);\n    });\n\n    socket.on(\"output\", data => {\n      if (data.length) updateList(data);\n    });\n\n    socket.on(\"cleared\", () => {\n      clearList();\n    });\n\n    socket.on(\"status\", data => {\n      setStatus(typeof data === \"object\" ? data.message : data);\n\n      // If status is clear, clear text\n      if (data.clear) {\n        textarea.value = \"\";\n      }\n    });\n  };\n  //=======================================Ask===========================================\n  const sendMessage = () => {\n    //以 emit 送訊息，並以 getMessage 為名稱送給 server 捕捉\n    socket.emit(\"getMessage\", \"只回傳給發送訊息的 client\");\n  };\n\n  const updateList = data => {\n    for (let x = 0; x < data.length; x++) {\n      // Building out message div\n      const message = document.createElement(\"div\");\n      message.setAttribute(\"class\", \"chat-message\");\n      message.textContent = data[x].name + \": \" + data[x].body;\n      messages.appendChild(message);\n\n      //            messages.insertBefore(message, messages.firstChild)\n    }\n  };\n  const updateFile = data => {\n    fileArray = data.slice(0);\n  };\n  const Question = e => {\n    if (e.key === \"Enter\" && e.shiftKey == false) {\n      // Emit to server input\n      socket.emit(\"input\", {\n        name: username.value,\n        body: textarea.value\n      });\n      e.preventDefault();\n      textarea.value = \"\";\n    }\n  };\n  //====================================Clear========================================\n  const Clear = () => {\n    clearList();\n    socket.emit(\"clear\");\n  };\n\n  // Clear Message\n\n  const clearList = () => {\n    messages.textContent = \"\";\n    username.value = \"\";\n    username.focus();\n  };\n  //======================================File=======================================\n\n  const add = () => {\n    // Emit to server input\n    const fileName = document.getElementById(\"filename\");\n    const fileUrl = document.getElementById(\"url\");\n    const status = document.getElementById(\"status\");\n    var check = checkUrl(fileUrl.value);\n    if (check === \"pdf\") {\n      socket.emit(\"file\", {\n        filename: fileName.value,\n        url: fileUrl.value\n      });\n      fileUrl.value = \"\";\n      fileName.value = \"\";\n      status.style.color = \"lightgreen\";\n    } else {\n      setStatus(\"This is not a pdf\");\n      status.style.color = \" rgb(172, 51, 51)\";\n      console.log(\"not a pdf\");\n    }\n  };\n  const deleteFile = e => {\n    console.log(e.target);\n  };\n\n  const checkUrl = url => {\n    var lastChar = url.substring(url.length - 3, url.length);\n    return lastChar;\n  };\n  //=====================================Satus=======================================\n  const setStatus = s => {\n    // Setting status\n    const status = document.getElementById(\"status\");\n    status.textContent = s;\n\n    // Resetting status to default every x seconds\n    if (s !== \"\") {\n      setTimeout(() => {\n        setStatus(\"\");\n      }, 2000);\n    }\n  };\n\n  //==================================================================================\n\n  return (\n    <BrowserRouter>\n      <div className=\"Wrapper\">\n        <div className=\"container\">\n          <div className=\"row\">\n            <Menu />\n            <div className=\"Add\">\n              <Switch>\n                <Route\n                  path=\"/home\"\n                  render={props => <File {...props} add={add} />}\n                />\n                <Route\n                  path=\"/classes/\"\n                  render={props => (\n                    <ClassList\n                      {...props}\n                      fileArray={fileArray}\n                      d={deleteFile}\n                    />\n                  )}\n                />{\" \"}\n                />\n                <Route\n                  path=\"/class/:id?\"\n                  render={props => <Slide {...props} fileArray={fileArray} />}\n                />\n              </Switch>\n            </div>\n            <Chat ask={Question} Clear={Clear} />\n          </div>\n        </div>\n      </div>\n    </BrowserRouter>\n  );\n}\n\nexport default App;\n/*\n render={props => (\n                    <ClassList {...props} fileArray={fileArray} />\n                  )}\n                  */\n"]},"metadata":{},"sourceType":"module"}