{"ast":null,"code":"import _slicedToArray from \"/Users/Hsi/Desktop/WebProg2019/mid/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/Hsi/Desktop/WebProg2019/mid/src/container/App.js\";\nimport React, { useState, useEffect, Component } from \"react\";\nimport { BrowserRouter, NavLink, Switch, Route, Redirect } from \"react-router-dom\";\nimport ReactDom from \"react-dom\";\nimport \"./index.css\";\nimport webSocket from \"socket.io-client\";\nimport File from \"./components/File\";\nimport Chat from \"./components/Question\";\nimport Menu from \"./components/menu\";\nimport PDF from \"./components/PDF\";\nimport { Button, Input } from \"antd\";\nimport \"antd/dist/antd.css\"; //=============================Variables=================================\n\nfunction App() {\n  // Getting Elements\n  const element = id => {\n    return document.getElementById(id);\n  };\n\n  const status = element(\"status\");\n  const messages = element(\"messages\");\n  const textarea = element(\"textarea\");\n  const username = element(\"username\");\n  const clearBtn = element(\"clear\");\n  const fileName = element(\"filename\");\n  const fileUrl = element(\"url\");\n  const list = element(\"list\");\n\n  const _useState = useState(null),\n        _useState2 = _slicedToArray(_useState, 2),\n        socket = _useState2[0],\n        setSocket = _useState2[1];\n\n  let c = 0; //==============================Server=================================\n\n  const connectWebSocket = () => {//開啟\n  };\n\n  useEffect(() => {\n    if (c === 0) {\n      setSocket(webSocket(\"http://localhost:3000\"));\n      c = 1;\n    }\n  }, [c]);\n  useEffect(() => {\n    if (socket) {\n      console.log(status.textContent);\n      initWebSocket();\n    }\n  }, [socket]);\n\n  const initWebSocket = () => {\n    //對 getMessage 設定監聽，如果 server 有透過 getMessage 傳送訊息，將會在此被捕捉\n    socket.on(\"getMessage\", message => {\n      console.log(message);\n    });\n    socket.on(\"fileOutput\", data => {\n      const showPdf = element(\"showPdf\");\n      console.log(PDF); //showPdf.setAttribute(\"src\", data.url);\n    });\n    socket.on(\"fileRender\", data => {\n      console.log(\"file\");\n      if (data.length && list.childNodes.length === 0) updateFile(data);\n    });\n    socket.on(\"init\", data => {\n      if (data.length && messages.childNodes.length === 0) updateList(data);\n    });\n    socket.on(\"output\", data => {\n      if (data.length) updateList(data);\n    });\n    socket.on(\"cleared\", () => {\n      clearList();\n    });\n  }; //=======================================Ask===========================================\n\n\n  const sendMessage = () => {\n    //以 emit 送訊息，並以 getMessage 為名稱送給 server 捕捉\n    socket.emit(\"getMessage\", \"只回傳給發送訊息的 client\");\n  };\n\n  const updateList = data => {\n    for (let x = 0; x < data.length; x++) {\n      // Building out message div\n      const message = document.createElement(\"div\");\n      message.setAttribute(\"class\", \"chat-message\");\n      message.textContent = data[x].name + \": \" + data[x].body;\n      messages.appendChild(message); //            messages.insertBefore(message, messages.firstChild)\n    }\n  };\n\n  const updateFile = data => {\n    for (let x = 0; x < data.length; x++) {\n      // Building out message div\n      const file = document.createElement(\"div\");\n      file.setAttribute(\"class\", \"fileList\");\n      file.textContent = data[x].filename;\n      list.appendChild(file); //            messages.insertBefore(message, messages.firstChild)\n    }\n  };\n\n  const Question = e => {\n    if (e.key === \"Enter\" && e.shiftKey == false) {\n      // Emit to server input\n      socket.emit(\"input\", {\n        name: username.value,\n        body: textarea.value\n      });\n      e.preventDefault();\n    }\n  }; //=================================================================================\n\n\n  const Clear = () => {\n    clearList();\n    socket.emit(\"clear\");\n  }; // Clear Message\n\n\n  const clearList = () => {\n    messages.textContent = \"\";\n    username.value = \"\";\n    username.focus();\n  }; //======================================File=======================================\n\n\n  const add = e => {\n    if (e.key === \"Enter\" && e.shiftKey == false) {\n      // Emit to server input\n      socket.emit(\"file\", {\n        filename: fileName.value,\n        url: fileUrl.value\n      });\n    }\n  };\n\n  return React.createElement(BrowserRouter, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"Wrapper\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"row\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147\n    },\n    __self: this\n  }, React.createElement(Menu, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: \"Add\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149\n    },\n    __self: this\n  }, React.createElement(Switch, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150\n    },\n    __self: this\n  }, React.createElement(Route, {\n    path: \"/home\",\n    render: props => React.createElement(File, Object.assign({}, props, {\n      add: add,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153\n      },\n      __self: this\n    })),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151\n    },\n    __self: this\n  }), React.createElement(Route, {\n    path: \"/class\",\n    component: PDF,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155\n    },\n    __self: this\n  }), React.createElement(Route, {\n    path: \"/class/:id?\",\n    component: ClassList,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156\n    },\n    __self: this\n  }))), React.createElement(Chat, {\n    ask: Question,\n    Clear: Clear,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159\n    },\n    __self: this\n  })))));\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/Hsi/Desktop/WebProg2019/mid/src/container/App.js"],"names":["React","useState","useEffect","Component","BrowserRouter","NavLink","Switch","Route","Redirect","ReactDom","webSocket","File","Chat","Menu","PDF","Button","Input","App","element","id","document","getElementById","status","messages","textarea","username","clearBtn","fileName","fileUrl","list","socket","setSocket","c","connectWebSocket","console","log","textContent","initWebSocket","on","message","data","showPdf","length","childNodes","updateFile","updateList","clearList","sendMessage","emit","x","createElement","setAttribute","name","body","appendChild","file","filename","Question","e","key","shiftKey","value","preventDefault","Clear","focus","add","url","props","ClassList"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, Component } from \"react\";\nimport {\n  BrowserRouter,\n  NavLink,\n  Switch,\n  Route,\n  Redirect\n} from \"react-router-dom\";\nimport ReactDom from \"react-dom\";\nimport \"./index.css\";\nimport webSocket from \"socket.io-client\";\nimport File from \"./components/File\";\nimport Chat from \"./components/Question\";\nimport Menu from \"./components/menu\";\nimport PDF from \"./components/PDF\";\nimport { Button, Input } from \"antd\";\nimport \"antd/dist/antd.css\";\n//=============================Variables=================================\nfunction App() {\n  // Getting Elements\n  const element = id => {\n    return document.getElementById(id);\n  };\n  const status = element(\"status\");\n  const messages = element(\"messages\");\n  const textarea = element(\"textarea\");\n  const username = element(\"username\");\n  const clearBtn = element(\"clear\");\n  const fileName = element(\"filename\");\n  const fileUrl = element(\"url\");\n  const list = element(\"list\");\n  const [socket, setSocket] = useState(null);\n  let c = 0;\n\n  //==============================Server=================================\n  const connectWebSocket = () => {\n    //開啟\n  };\n\n  useEffect(() => {\n    if (c === 0) {\n      setSocket(webSocket(\"http://localhost:3000\"));\n      c = 1;\n    }\n  }, [c]);\n\n  useEffect(() => {\n    if (socket) {\n      console.log(status.textContent);\n      initWebSocket();\n    }\n  }, [socket]);\n\n  const initWebSocket = () => {\n    //對 getMessage 設定監聽，如果 server 有透過 getMessage 傳送訊息，將會在此被捕捉\n    socket.on(\"getMessage\", message => {\n      console.log(message);\n    });\n\n    socket.on(\"fileOutput\", data => {\n      const showPdf = element(\"showPdf\");\n      console.log(PDF);\n      //showPdf.setAttribute(\"src\", data.url);\n    });\n    socket.on(\"fileRender\", data => {\n      console.log(\"file\");\n      if (data.length && list.childNodes.length === 0) updateFile(data);\n    });\n\n    socket.on(\"init\", data => {\n      if (data.length && messages.childNodes.length === 0) updateList(data);\n    });\n\n    socket.on(\"output\", data => {\n      if (data.length) updateList(data);\n    });\n\n    socket.on(\"cleared\", () => {\n      clearList();\n    });\n  };\n  //=======================================Ask===========================================\n  const sendMessage = () => {\n    //以 emit 送訊息，並以 getMessage 為名稱送給 server 捕捉\n    socket.emit(\"getMessage\", \"只回傳給發送訊息的 client\");\n  };\n\n  const updateList = data => {\n    for (let x = 0; x < data.length; x++) {\n      // Building out message div\n      const message = document.createElement(\"div\");\n      message.setAttribute(\"class\", \"chat-message\");\n      message.textContent = data[x].name + \": \" + data[x].body;\n      messages.appendChild(message);\n      //            messages.insertBefore(message, messages.firstChild)\n    }\n  };\n  const updateFile = data => {\n    for (let x = 0; x < data.length; x++) {\n      // Building out message div\n      const file = document.createElement(\"div\");\n      file.setAttribute(\"class\", \"fileList\");\n      file.textContent = data[x].filename;\n      list.appendChild(file);\n      //            messages.insertBefore(message, messages.firstChild)\n    }\n  };\n  const Question = e => {\n    if (e.key === \"Enter\" && e.shiftKey == false) {\n      // Emit to server input\n      socket.emit(\"input\", {\n        name: username.value,\n        body: textarea.value\n      });\n      e.preventDefault();\n    }\n  };\n  //=================================================================================\n  const Clear = () => {\n    clearList();\n    socket.emit(\"clear\");\n  };\n\n  // Clear Message\n\n  const clearList = () => {\n    messages.textContent = \"\";\n    username.value = \"\";\n    username.focus();\n  };\n  //======================================File=======================================\n\n  const add = e => {\n    if (e.key === \"Enter\" && e.shiftKey == false) {\n      // Emit to server input\n      socket.emit(\"file\", {\n        filename: fileName.value,\n        url: fileUrl.value\n      });\n    }\n  };\n\n  return (\n    <BrowserRouter>\n      <div className=\"Wrapper\">\n        <div className=\"container\">\n          <div className=\"row\">\n            <Menu />\n            <div className=\"Add\">\n              <Switch>\n                <Route\n                  path=\"/home\"\n                  render={props => <File {...props} add={add} />}\n                />\n                <Route path=\"/class\" component={PDF} />\n                <Route path=\"/class/:id?\" component={ClassList} />\n              </Switch>\n            </div>\n            <Chat ask={Question} Clear={Clear} />\n          </div>\n        </div>\n      </div>\n    </BrowserRouter>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}